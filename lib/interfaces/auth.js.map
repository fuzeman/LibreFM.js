{"version":3,"sources":["interfaces/auth.js"],"names":["AuthInterface","options","params","_client","key","callbackUrl","token","encode","username","password","Error","http","get","signed","then","body","session"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;;;;;;;;;;;;;;;IAGqBA,a;;;;;;;;;;;;;oCACDC,O,EAAS;AACrB,UAAIC,SAAS,EAAb;AAEAD,gBAAU,wBAAUA,OAAV,IAAqBA,OAArB,GAA+B,EAAzC,CAHqB,CAKrB;;AACAC,aAAO,SAAP,IAAoB,KAAKC,OAAL,CAAaC,GAAjC;;AAEA,UAAG,wBAAUH,QAAQI,WAAlB,CAAH,EAAmC;AAC/BH,eAAO,IAAP,IAAeD,QAAQI,WAAvB;AACH;;AAED,UAAG,wBAAUJ,QAAQK,KAAlB,CAAH,EAA6B;AACzBJ,eAAO,OAAP,IAAkBD,QAAQK,KAA1B;AACH,OAdoB,CAgBrB;;;AACA,aAAO,gCAAgC,qBAAYC,MAAZ,CAAmBL,MAAnB,CAAvC;AACH;;;qCAEgBM,Q,EAAUC,Q,EAAU;AACjC,UAAG,CAAC,wBAAUD,QAAV,CAAJ,EAAyB;AACrB,cAAM,IAAIE,KAAJ,CAAU,qDAAV,CAAN;AACH;;AAED,UAAG,CAAC,wBAAUD,QAAV,CAAJ,EAAyB;AACrB,cAAM,IAAIC,KAAJ,CAAU,qDAAV,CAAN;AACH;;AAED,aAAO,KAAKC,IAAL,CAAUC,GAAV,CAAc,uBAAd,EAAuC;AAC1CV,gBAAQ;AACJM,oBAAUA,QADN;AAEJC,oBAAUA;AAFN,SADkC;AAM1CI,gBAAQ;AANkC,OAAvC,EAOJC,IAPI,CAOC,UAASC,IAAT,EAAe;AACnB,YAAG,wBAAUA,IAAV,KAAmB,wBAAUA,KAAKC,OAAf,CAAtB,EAA+C;AAC3C,iBAAOD,KAAKC,OAAZ;AACH;;AAED,eAAO,IAAP;AACH,OAbM,CAAP;AAcH;;;+BAEUV,K,EAAO;AACd,UAAG,CAAC,wBAAUA,KAAV,CAAJ,EAAsB;AAClB,cAAM,IAAII,KAAJ,CAAU,kDAAV,CAAN;AACH;;AAED,aAAO,KAAKC,IAAL,CAAUC,GAAV,CAAc,iBAAd,EAAiC;AACpCV,gBAAQ;AACJI,iBAAOA;AADH,SAD4B;AAKpCO,gBAAQ;AAL4B,OAAjC,EAMJC,IANI,CAMC,UAASC,IAAT,EAAe;AACnB,YAAG,wBAAUA,IAAV,KAAmB,wBAAUA,KAAKC,OAAf,CAAtB,EAA+C;AAC3C,iBAAOD,KAAKC,OAAZ;AACH;;AAED,eAAO,IAAP;AACH,OAZM,CAAP;AAaH;;;+BAEU;AACP,aAAO,KAAKL,IAAL,CAAUC,GAAV,CAAc,eAAd,EAA+B;AAClCC,gBAAQ;AAD0B,OAA/B,EAEJC,IAFI,CAEC,UAASC,IAAT,EAAe;AACnB,YAAG,wBAAUA,IAAV,KAAmB,wBAAUA,KAAKT,KAAf,CAAtB,EAA6C;AACzC,iBAAOS,KAAKT,KAAZ;AACH;;AAED,eAAO,IAAP;AACH,OARM,CAAP;AASH","file":"auth.js","sourcesContent":["import QueryString from 'querystring';\r\n\r\nimport Interface from './base';\r\nimport {isDefined} from '../core/helpers';\r\n\r\n\r\nexport default class AuthInterface extends Interface {\r\n    getAuthorizeUrl(options) {\r\n        var params = {};\r\n\r\n        options = isDefined(options) ? options : {};\r\n\r\n        // Set parameters\r\n        params['api_key'] = this._client.key;\r\n\r\n        if(isDefined(options.callbackUrl)) {\r\n            params['cb'] = options.callbackUrl;\r\n        }\r\n\r\n        if(isDefined(options.token)) {\r\n            params['token'] = options.token;\r\n        }\r\n\r\n        // Build URL\r\n        return 'https://libre.fm/api/auth/?' + QueryString.encode(params);\r\n    }\r\n\r\n    getMobileSession(username, password) {\r\n        if(!isDefined(username)) {\r\n            throw new Error('Invalid value provided for the \"username\" parameter');\r\n        }\r\n\r\n        if(!isDefined(password)) {\r\n            throw new Error('Invalid value provided for the \"password\" parameter');\r\n        }\r\n\r\n        return this.http.get('auth.getMobileSession', {\r\n            params: {\r\n                username: username,\r\n                password: password\r\n            },\r\n\r\n            signed: true\r\n        }).then(function(body) {\r\n            if(isDefined(body) && isDefined(body.session)) {\r\n                return body.session;\r\n            }\r\n\r\n            return null;\r\n        });\r\n    }\r\n\r\n    getSession(token) {\r\n        if(!isDefined(token)) {\r\n            throw new Error('Invalid value provided for the \"token\" parameter');\r\n        }\r\n\r\n        return this.http.get('auth.getSession', {\r\n            params: {\r\n                token: token\r\n            },\r\n\r\n            signed: true\r\n        }).then(function(body) {\r\n            if(isDefined(body) && isDefined(body.session)) {\r\n                return body.session;\r\n            }\r\n\r\n            return null;\r\n        });\r\n    }\r\n\r\n    getToken() {\r\n        return this.http.get('auth.getToken', {\r\n            signed: true\r\n        }).then(function(body) {\r\n            if(isDefined(body) && isDefined(body.token)) {\r\n                return body.token;\r\n            }\r\n\r\n            return null;\r\n        });\r\n    }\r\n}\r\n"]}